<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title>INFINITI KAPITAL - Journal Profesional</title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2113.65">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Times; color: #000000; -webkit-text-stroke: #000000}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Times; color: #000000; -webkit-text-stroke: #000000; min-height: 14.0px}
    span.s1 {font-kerning: none}
    span.s2 {font: 12.0px 'Apple Color Emoji'; font-kerning: none}
  </style>
</head>
<body>
<p class="p1"><span class="s1">&lt;!DOCTYPE html&gt;</span></p>
<p class="p1"><span class="s1">&lt;html lang="es"&gt;</span></p>
<p class="p1"><span class="s1">&lt;head&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;meta charset="UTF-8"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;title&gt;INFINITI KAPITAL - Journal Profesional&lt;/title&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;script src="https://cdn.jsdelivr.net/npm/chart.js"&gt;&lt;/script&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;style&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>:root {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>--primary: #0f172a; --secondary: #1e293b; --accent: #d4af37;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>--success: #10b981; --warning: #f59e0b; --danger: #ef4444;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>--card-bg: rgba(15, 23, 42, 0.8); --border: rgba(255, 255, 255, 0.1);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>--text-primary: #f1f5f9; --text-secondary: #94a3b8;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>* { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>body { background: linear-gradient(135deg, var(--primary), var(--secondary)); color: var(--text-primary); min-height: 100vh; display: grid; grid-template-columns: 240px minmax(0, 1fr); grid-template-rows: 70px 1fr; grid-template-areas: "sidebar header" "sidebar main"; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>header { grid-area: header; background: var(--secondary); padding: 0 25px; display: flex; align-items: center; justify-content: space-between; border-bottom: 1px solid var(--border); box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1); z-index: 10; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.header-content { display: flex; align-items: center; gap: 15px; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.date-display { font-size: 1.1rem; color: var(--text-secondary); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.user-controls { display: flex; align-items: center; gap: 20px; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.user-info { display: flex; align-items: center; gap: 10px; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.user-avatar { width: 40px; height: 40px; border-radius: 50%; background: var(--accent); display: flex; align-items: center; justify-content: center; font-weight: bold; color: var(--primary); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.user-name { font-weight: 600; color: var(--accent); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.sidebar { grid-area: sidebar; background: rgba(15, 23, 42, 0.95); border-right: 1px solid var(--border); display: flex; flex-direction: column; padding: 20px 0; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.logo { padding: 0 20px 20px; border-bottom: 1px solid var(--border); margin-bottom: 20px; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.logo-infiniti { font-size: 1.8rem; font-weight: 800; letter-spacing: -1px; color: white; line-height: 1; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.logo-kapital { font-size: 1.5rem; font-weight: 800; letter-spacing: -1px; color: var(--accent); line-height: 1; margin-top: -5px; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.nav-menu { display: flex; flex-direction: column; gap: 5px; padding: 0 15px; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.nav-item { display: flex; align-items: center; gap: 12px; padding: 12px 15px; border-radius: 8px; color: var(--text-secondary); text-decoration: none; transition: all 0.3s ease; cursor: pointer; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.nav-item:hover, .nav-item.active { background: rgba(212, 175, 55, 0.1); color: var(--accent); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.nav-item i { width: 24px; text-align: center; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>main { grid-area: main; padding: 25px; overflow-y: auto; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.card { background: var(--card-bg); border-radius: 12px; padding: 20px; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); border: 1px solid var(--border); backdrop-filter: blur(5px); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.card-title { font-size: 1.2rem; font-weight: 600; color: var(--text-primary); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.btn-icon { background: transparent; border: none; color: var(--accent); font-size: 1rem; cursor: pointer; transition: all 0.3s ease; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.btn-icon:hover { color: #c9a227; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.section-content { display: none; grid-template-columns: repeat(12, 1fr); gap: 20px; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.section-content.active { display: grid; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.welcome-card { grid-column: span 8; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.metrics-summary { grid-column: span 4; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.profit-factor, .risk-reward, .win-trades { grid-column: span 4; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.distribution-card { grid-column: span 6; grid-row: span 2; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.recent-trades, .balance-evolution { grid-column: span 6; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.risk-analysis { grid-column: span 6; grid-row: span 2; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.news-card, .challenge-card { grid-column: span 6; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.metric-card { text-align: center; padding: 15px; border-radius: 8px; background: rgba(30, 41, 59, 0.5); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.metric-value { font-size: 1.8rem; font-weight: 700; color: var(--accent); margin-bottom: 5px; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.metric-label { font-size: 0.9rem; color: var(--text-secondary); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.metrics-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.summary-card { padding: 15px; border-radius: 8px; background: rgba(16, 185, 129, 0.1); border: 1px solid rgba(16, 185, 129, 0.2); margin-top: 15px; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.chart-container { height: 300px; margin-top: 15px; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.trades-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 15px; margin-top: 15px; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.trade-item { background: rgba(30, 41, 59, 0.5); border-radius: 8px; padding: 15px; border: 1px solid var(--border); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.trade-pair { font-weight: 600; font-size: 1.1rem; margin-bottom: 5px; color: var(--accent); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.trade-amount { font-size: 1.3rem; font-weight: 700; margin-bottom: 8px; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.trade-profit { color: var(--success); } .trade-loss { color: var(--danger); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.trade-meta { display: flex; justify-content: space-between; color: var(--text-secondary); font-size: 0.85rem; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.7); z-index: 1000; align-items: center; justify-content: center; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.modal-content { background: var(--card-bg); border-radius: 16px; width: 90%; max-width: 500px; padding: 25px; border: 1px solid var(--accent); box-shadow: 0 15px 35px rgba(0, 0, 0, 0.5); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 1px solid var(--accent); padding-bottom: 15px; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.modal-header h2 { color: var(--accent); font-size: 1.5rem; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.close-modal { background: none; border: none; color: #94a3b8; font-size: 1.5rem; cursor: pointer; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.form-group { margin-bottom: 20px; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.form-group label { display: block; margin-bottom: 8px; color: var(--text-secondary); font-weight: 500; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.form-control { width: 100%; padding: 12px; background: rgba(15, 23, 42, 0.5); border: 1px solid var(--border); border-radius: 8px; color: var(--text-primary); font-size: 1rem; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.modal-footer { display: flex; justify-content: flex-end; gap: 10px; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.btn-primary { background: var(--accent); color: var(--primary); border: none; padding: 10px 20px; border-radius: 8px; font-weight: 600; cursor: pointer; display: inline-flex; align-items: center; gap: 8px;}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.btn-secondary { background: #334155; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.add-trade-btn { position: fixed; bottom: 30px; right: 30px; width: 60px; height: 60px; border-radius: 50%; background: var(--accent); color: var(--primary); border: none; font-size: 1.5rem; cursor: pointer; box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3); display: flex; align-items: center; justify-content: center; z-index: 100; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.section-card { grid-column: span 12; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.empty-state { text-align: center; padding: 40px 20px; color: var(--text-secondary); grid-column: 1 / -1; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.empty-state i { font-size: 3rem; margin-bottom: 15px; color: var(--accent); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.accounts-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; margin-top: 20px; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.account-card { background: rgba(30, 41, 59, 0.5); border-radius: 12px; padding: 20px; border: 1px solid var(--border); position: relative; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.account-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.account-type { font-size: 0.9rem; padding: 5px 10px; border-radius: 20px; font-weight: 600; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.type-principal { background: rgba(212, 175, 55, 0.2); color: var(--accent); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.type-challenge { background: rgba(16, 185, 129, 0.2); color: var(--success); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.type-personal { background: rgba(59, 130, 246, 0.2); color: #3b82f6; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.account-actions button { background: transparent; border: none; color: var(--text-secondary); cursor: pointer; font-size: 1rem; transition: color 0.3s; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.account-balance { font-size: 2rem; font-weight: 700; margin-bottom: 10px; color: var(--accent); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.account-name { font-size: 1.2rem; color: var(--text-primary); margin-bottom: 10px; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.add-account-btn { display: flex; align-items: center; justify-content: center; background: rgba(30, 41, 59, 0.5); border: 2px dashed var(--border); border-radius: 12px; padding: 20px; cursor: pointer; transition: all 0.3s ease; flex-direction: column; min-height: 195px; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.add-account-btn:hover { border-color: var(--accent); background: rgba(212, 175, 55, 0.1); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.add-account-btn i { font-size: 2.5rem; margin-bottom: 15px; color: var(--accent); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>@media (max-width: 1200px) { .welcome-card, .metrics-summary, .distribution-card, .recent-trades, .balance-evolution, .risk-analysis, .news-card, .challenge-card { grid-column: span 12; } .profit-factor, .risk-reward, .win-trades { grid-column: span 4; } }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>@media (max-width: 768px) { body { grid-template-columns: 1fr; grid-template-areas: "header" "main"; } .sidebar { display: none; } .profit-factor, .risk-reward, .win-trades, .trades-grid, .risk-levels, .accounts-grid { grid-template-columns: 1fr; } }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.prose-custom { line-height: 1.6; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.prose-custom h3 { margin-bottom: 0.5rem; font-weight: 600; color: var(--accent); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.prose-custom strong { color: var(--text-primary); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.prose-custom p { margin-bottom: 1rem; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/style&gt;</span></p>
<p class="p1"><span class="s1">&lt;/head&gt;</span></p>
<p class="p1"><span class="s1">&lt;body&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;div id="app-root" class="contents"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;!-- Sidebar --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;aside class="sidebar"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div class="logo"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div class="logo-infiniti"&gt;INFINITI&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div class="logo-kapital"&gt;KAPITAL&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;nav class="nav-menu"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;a href="#" class="nav-item active" data-target="dashboard-content"&gt;&lt;i class="fas fa-chart-line"&gt;&lt;/i&gt;&lt;span&gt;Dashboard&lt;/span&gt;&lt;/a&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;a href="#" class="nav-item" data-target="cuentas-content"&gt;&lt;i class="fas fa-wallet"&gt;&lt;/i&gt;&lt;span&gt;Cuentas&lt;/span&gt;&lt;/a&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;a href="#" class="nav-item" data-target="analiticas-content"&gt;&lt;i class="fas fa-chart-bar"&gt;&lt;/i&gt;&lt;span&gt;Analíticas&lt;/span&gt;&lt;/a&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;a href="#" class="nav-item" data-target="calendario-content"&gt;&lt;i class="fas fa-calendar"&gt;&lt;/i&gt;&lt;span&gt;Calendario&lt;/span&gt;&lt;/a&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;a href="#" class="nav-item" data-target="seguimiento-content"&gt;&lt;i class="fas fa-tasks"&gt;&lt;/i&gt;&lt;span&gt;Seguimiento&lt;/span&gt;&lt;/a&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/nav&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/aside&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;!-- Header --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;header&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div class="header-content"&gt;&lt;div class="date-display"&gt;&lt;i class="fas fa-calendar"&gt;&lt;/i&gt; &lt;span id="current-date"&gt;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div class="user-controls"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div class="user-info"&gt;&lt;div class="user-avatar"&gt;IK&lt;/div&gt;&lt;div class="user-name"&gt;Invitado&lt;/div&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;button class="btn-icon"&gt;&lt;i class="fas fa-bell"&gt;&lt;/i&gt;&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/header&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;!-- Main Content --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;main&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;!-- Dashboard Section --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div id="dashboard-content" class="section-content active"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div class="card welcome-card"&gt;&lt;div class="card-header"&gt;&lt;h2 class="card-title"&gt;Bienvenido&lt;/h2&gt;&lt;/div&gt;&lt;p id="welcome-message"&gt;Cargando datos...&lt;/p&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div class="card metrics-summary"&gt;&lt;div class="card-header"&gt;&lt;h2 class="card-title"&gt;Resumen&lt;/h2&gt;&lt;/div&gt;&lt;div class="metrics-grid"&gt;&lt;div class="metric-card"&gt;&lt;div class="metric-value" id="total-profit"&gt;$0.00&lt;/div&gt;&lt;div class="metric-label"&gt;Beneficio Total&lt;/div&gt;&lt;/div&gt;&lt;div class="metric-card"&gt;&lt;div class="metric-value" id="win-rate"&gt;0%&lt;/div&gt;&lt;div class="metric-label"&gt;Tasa de Acierto&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div class="card profit-factor"&gt;&lt;div class="card-header"&gt;&lt;h2 class="card-title"&gt;Factor de Beneficio&lt;/h2&gt;&lt;/div&gt;&lt;div class="metric-card"&gt;&lt;div class="metric-value" id="profit-factor"&gt;0.00&lt;/div&gt;&lt;div class="metric-label"&gt;Total: &lt;span id="total-trades"&gt;0&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div class="card risk-reward"&gt;&lt;div class="card-header"&gt;&lt;h2 class="card-title"&gt;Riesgo/Beneficio&lt;/h2&gt;&lt;/div&gt;&lt;div class="metric-card"&gt;&lt;div class="metric-value" id="risk-reward"&gt;0.00&lt;/div&gt;&lt;div class="metric-label"&gt;Ratio Promedio&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div class="card win-trades"&gt;&lt;div class="card-header"&gt;&lt;h2 class="card-title"&gt;Operaciones Ganadoras&lt;/h2&gt;&lt;/div&gt;&lt;div class="metric-card"&gt;&lt;div class="metric-value" id="win-trades"&gt;0&lt;/div&gt;&lt;div class="metric-label"&gt;de &lt;span id="total-trades-2"&gt;0&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div class="card distribution-card"&gt;&lt;div class="card-header"&gt;&lt;h2 class="card-title"&gt;Distribución&lt;/h2&gt;&lt;/div&gt;&lt;div class="chart-container"&gt;&lt;canvas id="distributionChart"&gt;&lt;/canvas&gt;&lt;/div&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div class="card recent-trades"&gt;&lt;div class="card-header"&gt;&lt;h2 class="card-title"&gt;Recientes&lt;/h2&gt;&lt;/div&gt;&lt;div class="trades-grid" id="recent-trades-container"&gt;&lt;div class="empty-state"&gt;&lt;i class="fas fa-spinner fa-spin"&gt;&lt;/i&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div class="card balance-evolution"&gt;&lt;div class="card-header"&gt;&lt;h2 class="card-title"&gt;Evolución de Saldo&lt;/h2&gt;&lt;/div&gt;&lt;div class="chart-container"&gt;&lt;canvas id="balanceChart"&gt;&lt;/canvas&gt;&lt;/div&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div class="card risk-analysis"&gt;&lt;div class="card-header"&gt;&lt;h2 class="card-title"&gt;Análisis de Riesgo&lt;/h2&gt;&lt;/div&gt;&lt;div class="chart-container"&gt;&lt;canvas id="riskChart"&gt;&lt;/canvas&gt;&lt;/div&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div id="cuentas-content" class="section-content"&gt;&lt;div class="card section-card"&gt;&lt;div class="card-header"&gt;&lt;h2 class="card-title"&gt;Gestión de Cuentas&lt;/h2&gt;&lt;/div&gt;&lt;div class="accounts-grid" id="accounts-container"&gt;&lt;div class="empty-state"&gt;&lt;i class="fas fa-spinner fa-spin"&gt;&lt;/i&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div id="analiticas-content" class="section-content"&gt;&lt;div class="card section-card"&gt;&lt;div class="card-header"&gt;&lt;h2 class="card-title"&gt;Análisis con IA&lt;/h2&gt;&lt;button id="psychology-report-btn" class="btn-primary"&gt;</span><span class="s2">🧠</span><span class="s1"> Generar Reporte&lt;/button&gt;&lt;/div&gt;&lt;div id="analytics-result-container" class="prose-custom p-4 mt-4 bg-gray-900/50 rounded-lg min-h-[200px]"&gt;&lt;div class="empty-state"&gt;&lt;i class="fas fa-magic"&gt;&lt;/i&gt;&lt;h3&gt;Análisis Avanzado&lt;/h3&gt;&lt;p&gt;Genera un reporte psicológico basado en tu historial.&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div id="calendario-content" class="section-content"&gt;&lt;div class="card section-card"&gt;&lt;div class="empty-state"&gt;&lt;i class="fas fa-calendar"&gt;&lt;/i&gt;&lt;h3&gt;Próximamente&lt;/h3&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div id="seguimiento-content" class="section-content"&gt;&lt;div class="card section-card"&gt;&lt;div class="empty-state"&gt;&lt;i class="fas fa-tasks"&gt;&lt;/i&gt;&lt;h3&gt;Próximamente&lt;/h3&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/main&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;button class="add-trade-btn" id="floating-add-trade-btn"&gt;&lt;i class="fas fa-plus"&gt;&lt;/i&gt;&lt;/button&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div id="add-trade-modal" class="modal"&gt;&lt;div class="modal-content"&gt;&lt;div class="modal-header"&gt;&lt;h2&gt;Agregar Operación&lt;/h2&gt;&lt;button class="close-modal"&gt;&amp;times;&lt;/button&gt;&lt;/div&gt;&lt;form&gt;&lt;div class="modal-body"&gt;&lt;div class="form-group"&gt;&lt;label for="trade-pair-input"&gt;Par&lt;/label&gt;&lt;select id="trade-pair-input" class="form-control"&gt;&lt;option value="EURUSD"&gt;EUR/USD&lt;/option&gt;&lt;option value="GBPUSD"&gt;GBP/USD&lt;/option&gt;&lt;option value="USDJPY"&gt;USD/JPY&lt;/option&gt;&lt;/select&gt;&lt;/div&gt;&lt;div class="form-group"&gt;&lt;label for="trade-type-input"&gt;Tipo&lt;/label&gt;&lt;select id="trade-type-input" class="form-control"&gt;&lt;option value="buy"&gt;Compra&lt;/option&gt;&lt;option value="sell"&gt;Venta&lt;/option&gt;&lt;/select&gt;&lt;/div&gt;&lt;div class="form-group"&gt;&lt;label for="trade-result-input"&gt;Resultado ($)&lt;/label&gt;&lt;input type="number" id="trade-result-input" class="form-control" placeholder="Ej: 250.50" step="0.01"&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="modal-footer"&gt;&lt;button type="button" class="btn-secondary" id="cancel-trade-btn"&gt;Cancelar&lt;/button&gt;&lt;button type="submit" class="btn-primary" id="save-trade-btn"&gt;Guardar&lt;/button&gt;&lt;/div&gt;&lt;/form&gt;&lt;/div&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div id="add-account-modal" class="modal"&gt;&lt;div class="modal-content"&gt;&lt;div class="modal-header"&gt;&lt;h2 id="account-modal-title"&gt;Agregar Cuenta&lt;/h2&gt;&lt;button class="close-modal"&gt;&amp;times;&lt;/button&gt;&lt;/div&gt;&lt;form&gt;&lt;div class="modal-body"&gt;&lt;div class="form-group"&gt;&lt;label for="account-name"&gt;Nombre&lt;/label&gt;&lt;input type="text" id="account-name" class="form-control" placeholder="Ej: Cuenta Principal"&gt;&lt;/div&gt;&lt;div class="form-group"&gt;&lt;label for="account-balance"&gt;Saldo ($)&lt;/label&gt;&lt;input type="number" id="account-balance" class="form-control" placeholder="Ej: 10000.00" step="0.01"&gt;&lt;/div&gt;&lt;div class="form-group"&gt;&lt;label for="account-type"&gt;Tipo&lt;/label&gt;&lt;select id="account-type" class="form-control"&gt;&lt;option value="principal"&gt;Principal&lt;/option&gt;&lt;option value="challenge"&gt;Challenge&lt;/option&gt;&lt;option value="personal"&gt;Personal&lt;/option&gt;&lt;/select&gt;&lt;/div&gt;&lt;input type="hidden" id="editing-account-id"&gt;&lt;/div&gt;&lt;div class="modal-footer"&gt;&lt;button type="button" class="btn-secondary" id="cancel-account-btn"&gt;Cancelar&lt;/button&gt;&lt;button type="submit" class="btn-primary" id="save-account-btn"&gt;Guardar&lt;/button&gt;&lt;/div&gt;&lt;/form&gt;&lt;/div&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;script type="module"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>import { getAuth, signInAnonymously, onAuthStateChanged, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>import { getFirestore, collection, addDoc, onSnapshot, serverTimestamp, query, doc, deleteDoc, updateDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const firebaseConfigStr = typeof __firebase_config !== 'undefined' ? __firebase_config : '{}';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const firebaseConfig = JSON.parse(firebaseConfigStr);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (!firebaseConfig.apiKey) throw new Error("La configuración de Firebase está ausente o incompleta. Sigue la guía para configurarla.");</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const app = initializeApp(firebaseConfig);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const auth = getAuth(app);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const db = getFirestore(app);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const appId = (typeof __app_id !== 'undefined' ? __app_id : 'default-app-id').replace(/\//g, '_');</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>let userId = null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>let allTrades = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>let allAccounts = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>let distributionChart, balanceChart, riskChart;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// --- DOM Elements ---</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const ui = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>addTradeModal: document.getElementById('add-trade-modal'),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>addAccountModal: document.getElementById('add-account-modal'),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>openModalButtons: document.querySelectorAll('#add-trade-btn, #floating-add-trade-btn'),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>saveTradeBtn: document.getElementById('save-trade-btn'),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>saveAccountBtn: document.getElementById('save-account-btn'),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>recentTradesContainer: document.getElementById('recent-trades-container'),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>accountsContainer: document.getElementById('accounts-container'),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>psychologyReportBtn: document.getElementById('psychology-report-btn'),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>analyticsResultContainer: document.getElementById('analytics-result-container'),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// --- Navigation ---</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>document.querySelectorAll('.nav-item').forEach(item =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>item.addEventListener('click', function(e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>e.preventDefault();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>document.querySelectorAll('.nav-item').forEach(i =&gt; i.classList.remove('active'));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>this.classList.add('active');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>const targetId = this.getAttribute('data-target');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>document.querySelectorAll('.section-content').forEach(s =&gt; s.classList.remove('active'));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>const targetSection = document.getElementById(targetId);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>if (targetSection) targetSection.classList.add('active');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// --- Authentication ---</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>onAuthStateChanged(auth, async user =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (user) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>userId = user.uid;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>loadData();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>if (typeof __initial_auth_token !== 'undefined') await signInWithCustomToken(auth, __initial_auth_token);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>else await signInAnonymously(auth);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>} catch (error) { console.error("Authentication error:", error); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// --- Data Loading ---</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>function loadData() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (!userId) return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>initCharts();</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const tradesQuery = query(collection(db, `artifacts/${appId}/users/${userId}/trades`));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>onSnapshot(tradesQuery, snapshot =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>allTrades = snapshot.docs.map(doc =&gt; ({ id: doc.id, ...doc.data() }));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>allTrades.sort((a, b) =&gt; (b.timestamp?.toMillis() || 0) - (a.timestamp?.toMillis() || 0));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>updateDashboardUI();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const accountsQuery = query(collection(db, `artifacts/${appId}/users/${userId}/accounts`));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>onSnapshot(accountsQuery, snapshot =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>allAccounts = snapshot.docs.map(doc =&gt; ({ id: doc.id, ...doc.data() }));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>renderAccounts();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>updateCharts(); // Update charts when accounts data changes</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// --- UI Updates &amp; Rendering ---</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>function updateDashboardUI() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const totalTrades = allTrades.length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const winTrades = allTrades.filter(t =&gt; t.result &gt; 0).length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const totalProfit = allTrades.reduce((sum, t) =&gt; sum + t.result, 0);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const winRate = totalTrades &gt; 0 ? (winTrades / totalTrades) * 100 : 0;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const grossProfit = allTrades.filter(t =&gt; t.result &gt; 0).reduce((s, t) =&gt; s + t.result, 0);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const grossLoss = Math.abs(allTrades.filter(t =&gt; t.result &lt; 0).reduce((s, t) =&gt; s + t.result, 0));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const profitFactor = grossLoss &gt; 0 ? grossProfit / grossLoss : 0;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById('total-profit').textContent = `$${totalProfit.toFixed(2)}`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById('win-rate').textContent = `${winRate.toFixed(1)}%`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById('profit-factor').textContent = profitFactor.toFixed(2);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById('win-trades').textContent = winTrades;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById('total-trades').textContent = totalTrades;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById('total-trades-2').textContent = totalTrades;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                 </span>document.getElementById('welcome-message').textContent = totalTrades &gt; 0 ? `Has completado ${totalTrades} operaciones.` : 'Aún no has realizado operaciones.';</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>renderRecentTrades();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>updateCharts();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>function renderRecentTrades() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (allTrades.length === 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>ui.recentTradesContainer.innerHTML = `&lt;div class="empty-state"&gt;&lt;i class="fas fa-file-alt"&gt;&lt;/i&gt;&lt;h3&gt;No hay operaciones&lt;/h3&gt;&lt;/div&gt;`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const recent = allTrades.slice(0, 4);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>ui.recentTradesContainer.innerHTML = recent.map(trade =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>const profitClass = trade.result &gt;= 0 ? 'trade-profit' : 'trade-loss';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>const sign = trade.result &gt;= 0 ? '+' : '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>const date = trade.timestamp ? new Date(trade.timestamp.seconds * 1000).toLocaleDateString('es-ES', {day:'2-digit', month:'2-digit'}) : 'N/A';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>return `&lt;div class="trade-item"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;div class="trade-pair"&gt;${trade.pair}&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;div class="trade-amount ${profitClass}"&gt;${sign}$${Math.abs(trade.result).toFixed(2)}&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;div class="trade-meta"&gt;&lt;span&gt;${date}&lt;/span&gt;&lt;span&gt;${trade.type.toUpperCase()}&lt;/span&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}).join('');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>function renderAccounts() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>let html = `&lt;div class="add-account-btn"&gt;&lt;i class="fas fa-plus"&gt;&lt;/i&gt;&lt;span&gt;Agregar Cuenta&lt;/span&gt;&lt;/div&gt;`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (allAccounts.length &gt; 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>html += allAccounts.map(account =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>const typeClasses = { principal: 'type-principal', challenge: 'type-challenge', personal: 'type-personal' };</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>return `&lt;div class="account-card" data-id="${account.id}"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>&lt;div class="account-header"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>&lt;div class="account-type ${typeClasses[account.type]}"&gt;${account.type.charAt(0).toUpperCase() + account.type.slice(1)}&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>&lt;div class="account-actions"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span>&lt;button class="edit-account" data-id="${account.id}"&gt;&lt;i class="fas fa-edit"&gt;&lt;/i&gt;&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span>&lt;button class="delete-account" data-id="${account.id}"&gt;&lt;i class="fas fa-trash"&gt;&lt;/i&gt;&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>&lt;div class="account-balance"&gt;$${account.balance.toFixed(2)}&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>&lt;div class="account-name"&gt;${account.name}&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}).join('');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>ui.accountsContainer.innerHTML = html;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// --- CRUD Operations ---</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>async function handleSaveTrade(e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>e.preventDefault();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const newTrade = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>pair: document.getElementById('trade-pair-input').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>type: document.getElementById('trade-type-input').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>result: parseFloat(document.getElementById('trade-result-input').value) || 0,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>timestamp: serverTimestamp()</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>await addDoc(collection(db, `artifacts/${appId}/users/${userId}/trades`), newTrade);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>ui.addTradeModal.style.display = 'none';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>e.target.closest('form').reset();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>async function handleSaveAccount(e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>e.preventDefault();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const editingId = document.getElementById('editing-account-id').value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const accountData = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>name: document.getElementById('account-name').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>balance: parseFloat(document.getElementById('account-balance').value) || 0,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>type: document.getElementById('account-type').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (editingId) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>await updateDoc(doc(db, `artifacts/${appId}/users/${userId}/accounts`, editingId), accountData);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>await addDoc(collection(db, `artifacts/${appId}/users/${userId}/accounts`), accountData);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>ui.addAccountModal.style.display = 'none';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>async function deleteAccount(id) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (confirm('¿Estás seguro de que quieres eliminar esta cuenta?')) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>await deleteDoc(doc(db, `artifacts/${appId}/users/${userId}/accounts`, id));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// --- Modals ---</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>function openAccountModal(account = null) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const form = ui.addAccountModal.querySelector('form');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>form.reset();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (account) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>document.getElementById('account-modal-title').textContent = 'Editar Cuenta';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>document.getElementById('account-name').value = account.name;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>document.getElementById('account-balance').value = account.balance;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>document.getElementById('account-type').value = account.type;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>document.getElementById('editing-account-id').value = account.id;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>document.getElementById('account-modal-title').textContent = 'Agregar Nueva Cuenta';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>document.getElementById('editing-account-id').value = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>ui.addAccountModal.style.display = 'flex';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// --- Gemini AI ---</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>ui.psychologyReportBtn.addEventListener('click', async () =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (allTrades.length &lt; 3) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>ui.analyticsResultContainer.innerHTML = `&lt;div class="empty-state"&gt;&lt;h3&gt;Datos Insuficientes&lt;/h3&gt;&lt;p&gt;Necesitas al menos 3 operaciones para generar un reporte.&lt;/p&gt;&lt;/div&gt;`; return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>ui.analyticsResultContainer.innerHTML = `&lt;div class="empty-state"&gt;&lt;i class="fas fa-spinner fa-spin"&gt;&lt;/i&gt;&lt;h3&gt;Generando Reporte...&lt;/h3&gt;&lt;/div&gt;`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const tradesForPrompt = allTrades.map(t =&gt; ({ result: t.result, pair: t.pair }));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const prompt = `Eres un psicólogo de trading. Analiza este historial de ${allTrades.length} operaciones: ${JSON.stringify(tradesForPrompt)}. Proporciona: 1. Un hábito positivo observado. 2. Un área de mejora emocional. 3. Una recomendación práctica. Sé conciso, usa markdown.`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>const result = await callGeminiAPI(prompt);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>ui.analyticsResultContainer.innerHTML = result;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>} catch (error) { ui.analyticsResultContainer.innerHTML = `&lt;div class="empty-state"&gt;&lt;i class="fas fa-exclamation-triangle"&gt;&lt;/i&gt;&lt;h3&gt;Error&lt;/h3&gt;&lt;p&gt;${error.message}&lt;/p&gt;&lt;/div&gt;`; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>async function callGeminiAPI(prompt) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const apiKey = ""; const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const payload = { contents: [{ parts: [{ text: prompt }] }] };</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const response = await fetch(apiUrl, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (!response.ok) throw new Error(`API Error: ${response.statusText}`);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const result = await response.json();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const text = result.candidates?.[0]?.content?.parts?.[0]?.text;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (text) return text.replace(/\n/g, '&lt;br&gt;').replace(/\*\*(.*?)\*\*/g, '&lt;strong&gt;$1&lt;/strong&gt;');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>throw new Error("Respuesta inválida de la API.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// --- Event Listeners ---</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>function setupEventListeners() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>updateCurrentDate();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>ui.openModalButtons.forEach(b =&gt; b.addEventListener('click', () =&gt; ui.addTradeModal.style.display = 'flex'));</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.querySelectorAll('.close-modal, #cancel-trade-btn, #cancel-account-btn').forEach(b =&gt; b.addEventListener('click', () =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>ui.addTradeModal.style.display = 'none';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>ui.addAccountModal.style.display = 'none';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}));</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>ui.addTradeModal.querySelector('form').addEventListener('submit', handleSaveTrade);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>ui.addAccountModal.querySelector('form').addEventListener('submit', handleSaveAccount);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>ui.accountsContainer.addEventListener('click', e =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>if (e.target.closest('.add-account-btn')) openAccountModal();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>if (e.target.closest('.edit-account')) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>const id = e.target.closest('.edit-account').dataset.id;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>const account = allAccounts.find(a =&gt; a.id === id);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>if(account) openAccountModal(account);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>if (e.target.closest('.delete-account')) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>const id = e.target.closest('.delete-account').dataset.id;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>deleteAccount(id);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// --- Charting ---</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>function initCharts(){</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const chartOptions = { responsive: true, maintainAspectRatio: false, plugins: { legend: { labels: { color: '#f1f5f9' } } }, scales: { y: { beginAtZero: true, grid: { color: 'rgba(255, 255, 255, 0.1)' }, ticks: { color: '#94a3b8' } }, x: { grid: { display: false }, ticks: { color: '#94a3b8' } } } };</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const radarOptions = { responsive: true, maintainAspectRatio: false, scales: { r: { angleLines: { color: 'rgba(255, 255, 255, 0.1)' }, grid: { color: 'rgba(255, 255, 255, 0.1)' }, pointLabels: { color: '#94a3b8' }, ticks: { display: false } } }, plugins: { legend: { labels: { color: '#f1f5f9' } } } };</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const distCtx = document.getElementById('distributionChart')?.getContext('2d');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (distCtx) distributionChart = new Chart(distCtx, { type: 'bar', data: { labels: ['Ganadoras', 'Perdedoras'], datasets: [{ data: [0, 0], backgroundColor: [ 'rgba(16, 185, 129, 0.7)', 'rgba(239, 68, 68, 0.7)'], borderWidth: 1 }] }, options: chartOptions });</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const balanceCtx = document.getElementById('balanceChart')?.getContext('2d');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (balanceCtx) balanceChart = new Chart(balanceCtx, { type: 'line', data: { labels: [], datasets: [{ label: 'Saldo', data: [], borderColor: 'rgba(212, 175, 55, 1)', fill: true, tension: 0.3 }] }, options: chartOptions });</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const riskCtx = document.getElementById('riskChart')?.getContext('2d');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (riskCtx) riskChart = new Chart(riskCtx, { type: 'radar', data: { labels: ['Acierto', 'Beneficio', 'R/B', 'Consistencia'], datasets: [{ label: 'Perfil', data: [0,0,0,0], backgroundColor: 'rgba(212, 175, 55, 0.2)', borderColor: 'rgba(212, 175, 55, 1)' }] }, options: radarOptions });</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>function updateCharts() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (!distributionChart || !balanceChart || !riskChart) return;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// Distribution Chart</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const wins = allTrades.filter(t =&gt; t.result &gt; 0).length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const losses = allTrades.filter(t =&gt; t.result &lt; 0).length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>distributionChart.data.datasets[0].data = [wins, losses];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>distributionChart.update();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// Balance Chart</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const principalAccount = allAccounts.find(a =&gt; a.type === 'principal');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>let startingBalance = 10000; // Default if no principal account</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if(principalAccount) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>startingBalance = principalAccount.balance;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>let runningBalance = startingBalance;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const balanceData = [runningBalance];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const balanceLabels = ['Inicio'];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>[...allTrades].reverse().forEach((trade, index) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>runningBalance += trade.result;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>balanceData.push(runningBalance);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>balanceLabels.push(`Op ${index + 1}`);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>balanceChart.data.labels = balanceLabels;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>balanceChart.data.datasets[0].data = balanceData;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>balanceChart.update();</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// Risk Chart</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const winRate = allTrades.length &gt; 0 ? (wins / allTrades.length) * 100 : 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const grossProfit = allTrades.filter(t =&gt; t.result &gt; 0).reduce((s, t) =&gt; s + t.result, 0);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const grossLoss = Math.abs(allTrades.filter(t =&gt; t.result &lt; 0).reduce((s, t) =&gt; s + t.result, 0));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const profitFactor = grossLoss &gt; 0 ? grossProfit / grossLoss : 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// Normalize for radar: winRate is 0-100, profit factor can be anything. Let's cap it at 5 and scale.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const riskData = [ winRate, Math.min(100, (grossProfit / startingBalance)*100 || 0) , Math.min(100, profitFactor * 20), 50 ]; // 50 for consistency placeholder</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>riskChart.data.datasets[0].data = riskData;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>riskChart.update();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>function updateCurrentDate() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const now = new Date();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById('current-date').textContent = now.toLocaleDateString('es-ES', options);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>setupEventListeners();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>} catch (error) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>console.error("Initialization Error:", error);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById('app-root').innerHTML = `&lt;div style="color:white; padding: 2rem; text-align: center; width: 100vw; height: 100vh; display: flex; align-items: center; justify-content: center; flex-direction: column;"&gt;&lt;h1&gt;Error de Configuración&lt;/h1&gt;&lt;p style="max-width: 500px;"&gt;${error.message}&lt;/p&gt;&lt;/div&gt;`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/script&gt;</span></p>
<p class="p1"><span class="s1">&lt;/body&gt;</span></p>
<p class="p1"><span class="s1">&lt;/html&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
</body>
</html>
